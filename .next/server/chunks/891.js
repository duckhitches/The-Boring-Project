"use strict";exports.id=891,exports.ids=[891],exports.modules={36891:(e,t,r)=>{r.d(t,{A1:()=>l});var a=r(43974);let i=process.env.SUPABASE_URL||"https://knfootifujbosyryeygm.supabase.co",n=process.env.SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtuZm9vdGlmdWpib3N5cnlleWdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzOTg5MTEsImV4cCI6MjA3Njk3NDkxMX0.y9o7Cuyakkd0oomERMT9GFopbSMKHrZWdlXxpZ5JQQo",o=null;i&&n?o=(0,a.eI)(i,n):console.warn("Supabase is not configured. Data will be stored locally only.");let s="project-backgrounds",l={async signUp(e,t,r){if(!o)throw Error("Supabase not configured");let{data:a,error:i}=await o.auth.signUp({email:e,password:t,options:{data:r?{first_name:r.firstName,last_name:r.lastName,full_name:`${r.firstName} ${r.lastName}`.trim()}:void 0}});return{user:a.user,error:i}},async signIn(e,t){if(!o)throw Error("Supabase not configured");let{data:r,error:a}=await o.auth.signInWithPassword({email:e,password:t});return{user:r.user,error:a}},async signOut(){if(!o)throw Error("Supabase not configured");let{error:e}=await o.auth.signOut();if(e)throw e},async getCurrentUser(){if(!o)throw Error("Supabase not configured");let{data:{user:e},error:t}=await o.auth.getUser();return{user:e,error:t}},onAuthStateChange(e){if(!o)throw Error("Supabase not configured");return o.auth.onAuthStateChange(e)},async resetPassword(e){if(!o)throw Error("Supabase not configured");let{error:t}=await o.auth.resetPasswordForEmail(e);return{error:t}},async getProjects(){if(!o)return[];try{let{data:{user:e}}=await o.auth.getUser();if(!e)return[];let{data:t,error:r}=await o.from("projects").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(r)throw r;let{data:a}=await o.from("profiles").select("first_name, last_name, email").eq("id",e.id).single();console.log("\uD83D\uDD0D DEBUG - Dashboard projects fetch:"),console.log("Current user_id:",e.id),console.log("Profile data:",a);let i=a?{firstName:a.first_name,lastName:a.last_name,email:a.email}:{firstName:e.user_metadata?.first_name,lastName:e.user_metadata?.last_name,email:e.email};return console.log("Final userInfo for dashboard:",i),(t||[]).map(e=>({id:e.id,projectName:e.project_name,timeline:e.timeline,description:e.description,codeSnippet:e.code_snippet,codeLanguage:e.code_language,screenshots:e.screenshots||[],githubLink:e.github_link,liveLink:e.live_link,contactEmail:e.contact_email,backgroundImage:e.background_image,tags:e.tags||[],startDate:e.start_date,endDate:e.end_date,userInfo:i}))}catch(e){return console.error("Error fetching projects:",e),[]}},async getProjectById(e){if(!o)return null;try{let{data:t,error:r}=await o.from("projects").select("*").eq("id",e).single();if(r)throw r;if(!t)return null;let{data:a,error:i}=await o.from("profiles").select("first_name, last_name, email").eq("id",t.user_id).single(),n=a&&!i?{firstName:a.first_name,lastName:a.last_name,email:a.email}:{firstName:"Anonymous",lastName:"User",email:`user-${t.user_id.slice(0,8)}@example.com`};return{id:t.id,projectName:t.project_name,timeline:t.timeline,description:t.description,codeSnippet:t.code_snippet,codeLanguage:t.code_language,screenshots:t.screenshots||[],githubLink:t.github_link,liveLink:t.live_link,contactEmail:t.contact_email,backgroundImage:t.background_image,tags:t.tags||[],startDate:t.start_date,endDate:t.end_date,userInfo:n}}catch(e){return console.error("Error fetching project by ID:",e),null}},async createProject(e){if(!o)return null;try{let{data:{user:t}}=await o.auth.getUser();if(!t)throw Error("User not authenticated");let r={project_name:e.projectName,timeline:e.timeline,description:e.description,code_snippet:e.codeSnippet,code_language:e.codeLanguage,screenshots:e.screenshots||[],github_link:e.githubLink,live_link:e.liveLink,contact_email:e.contactEmail,background_image:e.backgroundImage,tags:e.tags||[],start_date:e.startDate,end_date:e.endDate,user_id:t.id},{data:a,error:i}=await o.from("projects").insert([r]).select().single();if(i)throw i;return{id:a.id,projectName:a.project_name,timeline:a.timeline,description:a.description,codeSnippet:a.code_snippet,codeLanguage:a.code_language,screenshots:a.screenshots||[],githubLink:a.github_link,liveLink:a.live_link,contactEmail:a.contact_email,backgroundImage:a.background_image,tags:a.tags||[],startDate:a.start_date,endDate:a.end_date}}catch(e){return console.error("Error creating project:",e),null}},async updateProject(e,t){if(!o)return null;try{let{data:{user:r}}=await o.auth.getUser();if(!r)throw Error("User not authenticated");let a={};void 0!==t.projectName&&(a.project_name=t.projectName),void 0!==t.timeline&&(a.timeline=t.timeline),void 0!==t.description&&(a.description=t.description),void 0!==t.codeSnippet&&(a.code_snippet=t.codeSnippet),void 0!==t.codeLanguage&&(a.code_language=t.codeLanguage),void 0!==t.screenshots&&(a.screenshots=t.screenshots),void 0!==t.githubLink&&(a.github_link=t.githubLink),void 0!==t.liveLink&&(a.live_link=t.liveLink),void 0!==t.contactEmail&&(a.contact_email=t.contactEmail),void 0!==t.backgroundImage&&(a.background_image=t.backgroundImage),void 0!==t.tags&&(a.tags=t.tags),void 0!==t.startDate&&(a.start_date=t.startDate),void 0!==t.endDate&&(a.end_date=t.endDate);let{data:i,error:n}=await o.from("projects").update(a).eq("id",e).eq("user_id",r.id).select().single();if(n)throw n;return{id:i.id,projectName:i.project_name,timeline:i.timeline,description:i.description,codeSnippet:i.code_snippet,codeLanguage:i.code_language,screenshots:i.screenshots||[],githubLink:i.github_link,liveLink:i.live_link,contactEmail:i.contact_email,backgroundImage:i.background_image,tags:i.tags||[],startDate:i.start_date,endDate:i.end_date}}catch(e){return console.error("Error updating project:",e),null}},async deleteProject(e){if(!o)return!1;try{let{data:{user:t}}=await o.auth.getUser();if(!t)throw Error("User not authenticated");let{error:r}=await o.from("projects").delete().eq("id",e).eq("user_id",t.id);if(r)throw r;return!0}catch(e){return console.error("Error deleting project:",e),!1}},async getNotes(){if(!o)return[];try{let{data:{user:e}}=await o.auth.getUser();if(!e)return[];let{data:t,error:r}=await o.from("notes").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(r)throw r;return(t||[]).map(e=>({id:e.id,title:e.title,content:e.content,created_at:e.created_at,updated_at:e.updated_at,user_id:e.user_id}))}catch(e){return console.error("Error fetching notes:",e),[]}},async createNote(e){if(!o)return null;try{let{data:{user:t}}=await o.auth.getUser();if(!t)throw Error("User not authenticated");let{data:r,error:a}=await o.from("notes").insert([{title:e.title,content:e.content,user_id:t.id}]).select().single();if(a)throw a;return{id:r.id,title:r.title,content:r.content,created_at:r.created_at,updated_at:r.updated_at,user_id:r.user_id}}catch(e){return console.error("Error creating note:",e),null}},async updateNote(e,t){if(!o)return null;try{let{data:{user:r}}=await o.auth.getUser();if(!r)throw Error("User not authenticated");let{data:a,error:i}=await o.from("notes").update(t).eq("id",e).eq("user_id",r.id).select().single();if(i)throw i;return{id:a.id,title:a.title,content:a.content,created_at:a.created_at,updated_at:a.updated_at,user_id:a.user_id}}catch(e){return console.error("Error updating note:",e),null}},async deleteNote(e){if(!o)return!1;try{let{data:{user:t}}=await o.auth.getUser();if(!t)throw Error("User not authenticated");let{error:r}=await o.from("notes").delete().eq("id",e).eq("user_id",t.id);if(r)throw r;return!0}catch(e){return console.error("Error deleting note:",e),!1}},async uploadImage(e){if(!o)try{return URL.createObjectURL(e)}catch(e){return console.error("Error creating object URL for preview:",e),null}try{let t=`public/${Date.now()}-${e.name}`,{error:r}=await o.storage.from(s).upload(t,e);if(r)throw r;let{data:a}=o.storage.from(s).getPublicUrl(t);return a.publicUrl}catch(e){return console.error("Error uploading image to Supabase:",e),null}},async getUserProfile(e){if(!o)throw Error("Supabase not configured");let{data:t,error:r}=await o.from("profiles").select("*").eq("id",e).single();if(r){console.error("Error fetching profile:",r);let{data:e,error:t}=await o.auth.getUser();if(t)throw t;return{id:e.user?.id,email:e.user?.email,first_name:e.user?.user_metadata?.first_name,last_name:e.user?.user_metadata?.last_name,full_name:e.user?.user_metadata?.full_name,avatar_url:e.user?.user_metadata?.avatar_url,created_at:e.user?.created_at,updated_at:e.user?.updated_at}}return t},async updateUserProfile(e,t){if(!o)throw Error("Supabase not configured");let r={},a={};t.firstName&&(r.first_name=t.firstName,a.first_name=t.firstName),t.lastName&&(r.last_name=t.lastName,a.last_name=t.lastName),t.firstName&&t.lastName&&(r.full_name=`${t.firstName} ${t.lastName}`.trim(),a.full_name=`${t.firstName} ${t.lastName}`.trim());let{data:i,error:n}=await o.from("profiles").update(r).eq("id",e).select().single(),{data:s,error:l}=await o.auth.updateUser({data:a});if(n&&l)throw Error("Failed to update profile");return{user:s.user,error:n||l}},async deleteUser(){if(!o)throw Error("Supabase not configured");let{error:e}=await o.rpc("delete_user_account");if(e)throw e;return await o.auth.signOut(),{error:null}},async updatePassword(e,t){if(!o)throw Error("Supabase not configured");let{data:r}=await o.auth.getUser();if(!r.user?.email)throw Error("No user found");let{error:a}=await o.auth.signInWithPassword({email:r.user.email,password:e});if(a)throw Error("Current password is incorrect");let{error:i}=await o.auth.updateUser({password:t});return{error:i}}};l.uploadImage}};